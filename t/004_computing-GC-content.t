#!/usr/bin/env perl
use strict;
use warnings;
use Data::Dumper;
use Test::More tests=>2;
use Bio::SeqIO;

subtest 'sample data' => sub{
  my $dna = ">Rosalind_6404
CCTGCGGAAGATCGGCACTAGAATAGCCAGAACCGTTTCTCTGAGGCTTCCGGCCTTCCC
TCCCACTAATAATTCTGAGG
>Rosalind_5959
CCATCGGTAGCGCATCCTTAGTCCAATTAAGTCCCTATCCAGGCGCTCCGCCGAAGGTCT
ATATCCATTTGTCAGCAGACACGC
>Rosalind_0808
CCACCCTCGTGGTATGGCTAGGCATTCAGGAACCGGAGAACGCTTCAGACCAGCCCGGAC
TGGGAACCTGCGGGCAGTAGGTGGAAT";
  my $exp = "Rosalind_0808
60.920";
  my $obs = highestGc($dna);
  is($obs, $exp, $dna);
};

subtest 'real data' => sub{
  my $exp = "Rosalind_4325
51.773";
  local $/ = undef;
  my $dna = <DATA>;
  my $obs = highestGc($dna);
  is($obs, $exp, $dna);
};

sub highestGc{
  my($dna) = @_;

  my $maxGc = 0;
  my $maxId = "";
  my $in = Bio::SeqIO->new(-string=>$dna);
  while(my $seq = $in->next_seq()){
    my $sequence = $seq->seq;
    my $GC = () = $sequence =~ /[GC]/g;
    $GC = $GC / length($sequence) * 100;

    if($GC > $maxGc){
      $maxGc = sprintf("%0.3f", $GC);
      $maxId = $seq->id;
    }
  }

  return "$maxId\n$maxGc";
}

__DATA__
>Rosalind_4325
AATTAGCCTTAAGCTTGAGGTCCTTCAGCACGGTCGCCGGGAAATCGATAGCGACCATGT
TCCTATGGCGGTACTGTACAACAACGAACACGGGGGGAACCGGGGCGGAACGAATCTCAC
TATGACACGGGGATGAACATATATGTTTATTTCTACTGTCTTCCTGTTACAAAATTGATG
GAGGGTCTAGCGCAGCACAAGAAAGGACATCCTACGGCGGTACAGCCGGCGACGCCGGGC
CTGTTATGTTTTGTTGGCTCATCGGAAGTTGAGACAGGTGCATGTTTCGTGTCTCTACGG
CCCCGGGCCCATTAACCTCTGAGTAGTCCAGGCGGTCGTGAGTGCCTCACCCCCTTTCCA
GCCACTCACATAAAGTATCGGCCTTGAGATGGCTTAGACTAATCCGTGTAGGCTGTGATC
ATTGCTTTGGCGCAATCTTCGCAGCGATGCGCGCTCGTCATTTCTTATGATCGTCGGTTC
CAAAAAGGGCCCGCGAAGCACGCGTGCAGCGGTGCGGGCTTGTGGTAATTCTTGTCGTCC
TGCTTTTGCCTAGTAGGAGAAAGTAGCGGATATGCTTGCTTGCAGGGCTGATCGATAAAT
CATAGTAGGAAAACTCCAAATAACTGGGGCGAGCAGAATGACGGTATACAGTGGAGGGTC
TTAGCTTACGCGCCGTGTGGGACAAATTCGGAACAACTAAGCACCGTCGTAACCGATCTA
TCTGCGTTGACGTTACGTCTACGAATATCCACATTTGGTAGGGTTTAATGCCTCACCACG
GCGCAGGATGATCGAGTTAGCTCAAGGGTCACACCGGTACACATCCCAGACTCTGCTGCA
CAAAACCGATAGTCAAGGCCCAGTCGTAGATCCGATCTATGTGCCCTTCAGTGAGTCAGC
AACCAGCTTGACGGATAGCGAGCGTGCAACACGTATGGAAGTGGAAAAACTATGTGCCCA
GTGTACTTACTTCTCATACCCCGGACA
>Rosalind_8859
AAATAACCTGTAACGTCTTGGGGCCGGTGTACCACATGATTCTTTCGAAGCGAATAAATC
ATGCGGTGTCTGGACGATGCGAGGACTTCTTGGTTAATCTTTCATGTCTTGGCCTGGCAC
GGTGAGTGTTCGTGGTGGTGTAGTAGTGCGGGACCGTGTACCAGAGTACGTAGTCTGCTA
GGTAAGGCCAATCCTTATCCCTCTCACCGTTGTATTCCAGTCCTCTACTCCAGCCTTTAT
ACAGAAGTTACTGTAAATAGGCTATGACCGGACGACTGCATTCCCAGTATCCTCATACCG
TTCATGAAAGTAGGTTCTCGGAGGCCCAAAACAGAGATGTTCAGAGGTTGCAACAGCGAT
TGATGGCCCGAGGGATAGCGGCGACCATACCACTTCGCTTTGCACACTTACTAGGGTAGA
CCATGCACCACGTGCCTGTCCGCGGGAGGCCATACTCATGGTTCTCCTCTTCCATACTGC
TAGCTGACCTCTCCCACTCCAGACTCCCAGTAAGAGGTTCGAGAGAGCTGTACACATAGC
CCTCCGTCATGCGGGGGGAAGTCATTTCATAGCGATAAGCGTGGCGAACGGGGCGGACCT
ACAATGATCTCCCGACAAATCTTAGGGGGTCGCGAAACCAGTAAAGGGCCTTCAATTGTC
GGAGACACACTCCAAGATTCTTTAACAGCCGCTCGTGTGCTCTTTCATCTAAGGGATGAA
AGATAATCCAGGATAGCGGTCGCCCCTTTCCCCATATACCTCAGATTACCAATATAGATG
GCAGGGTATCGCCCCGGACCTAGGACGCATCTGGTATGTTGTTCGGCTGACTCCAACCGG
CCACCCATGATGTATGCTTGATTGTTCCGAATGAGCGTAGGGAGGTTAAACGGATTGCAT
CCGAGAATCTCAGA
>Rosalind_7199
GTCCTTGAATCACTGTGAATTAAACTGTACAGCATCCAGTCTAGAGCGAAAGAGTTTGTG
CCAACTCGGGCATGTACACCAAGATGCGCAGCGTTGCAGGAAGGAGACCTGGCGGGCCGT
TTGCGTGACATATAGTTCGCGTGACACGTGTCCTCTGCAGACGCGGGACCTGAGCGGTCA
TCCTATTCAGCCCGGAGCTAATGTGCCGACTCCTATTCTTGTTGACGGGGGTTTGCGAGT
GAGCCGAGTACTAAAGTATTGGCTCCAGCGCTGTGGCAGACCTTCTCTCCGGATCGTAAC
CGAGGCCGGCCCTATGAACACCTCTCGTCACGCATTGACATATGGTTAACGGATAAAAGA
AGATGGCGCAGTAGATCCGGGAAGTGTTTGGTCGATTCTTTCTATTTCTATGTCGGGGGA
GCAAACATCACACACCTTCTCGTGTCATCTCAACGAGTGTTATTTCCTGAACTTCTTGTA
GCGTTACGGCCCATGTAACCCTTGTGGTTTTTATCAAGACCCTCCTTGGTTAATCGAGAA
GGCTGTGTGGGGGCTTTAGTATCTTCTGGCATAGTATGTCATGAGCACGACGCAGCCTAA
GTTGCCACGTCTTTTACATAATACGAGCTTCATGATTGTCACACTAACGGAGTAGCGGGC
CTTACAAAACCACCACTATCGCTAGAAGTATAACGTTGATTCGGAATATTTTCAGAAACG
GACACAGGCTTAGGTGACTAATGAAAGACCTGTAAGAAGAACGTTGGTGGAGGGGTCTCG
ACCCGAAAGTTCCGCTATTAGCTACGATTCATGTATCAGCAACAGCGATCCGATTCTTGA
ATTTCAG
>Rosalind_6512
ACTATCCCTGTAATGGACCCGAGGATTACATATTGTCGATACTGGGGCGGCAGCAAAGAA
TATGTGATGGTTCCCCAGAAGTTTCGTTACGTGGAACCCACAAAGAGGCAATATTGGAGC
CCGGGAGCGACGCGCTGCTACACTTTATACACACGACCCACGGCGCAACCCTAGGCTCCG
ATTGGCTCACCCAACCCTTCATGCTCGCACAATAGACTTTCTCTTGGGGCAGCCAATGCT
AGAGACATCCCATTTGTCTCAGAAGCATACCGCCAGCGAGATCTGACTGTATTTTAATTG
CTTTTGAACTTTGTTCATTCAGTGTGCGCCGATCTCACAGGTGGAGCAGAACCCGTGTTG
AGGCCACGTGAGAGGGCGGCCATTTTAATGCTTATGGCCTGCAGCCACTGGAGCACTGCA
GCTCATTCTAGGCCAAGCAAGTCTCAATCCCTGACGAGGCGGAATGAGAGCGGAGGCCAC
CACAGATAGCGACATTGCTTGGCCCTATAGTTGTCTGGCACTCGGCGATGACTCCTGAGG
AGGAGCTGAAAGGTACGCGTTTACACAGCTTTTGACTAGTTAATCGATCTTACACGACTA
CTGGAGCAACATGTGAATTGGCTGCTCCGAGGTGTCTTCCAACATCCGTCCACTATTGCA
AAGGAACCAATTAAACTAAGGCTGCGTCGAGCCCTTGATACAAGAAAGACTTCGCCCCGG
TTCAGAGCTCTGCACGCAATCGCTCGTGGGCCTTATATTAACGAATAACTTCGAGGATTC
TTTTTTTGCTTGCGCTTATTCTTGAAAGTCAAACGTAGTCGGTATTAAACCGGGGTGGCG
GAAGTAATTAAGACTTGGGTGTCCTCATCAACGCTGGGCGATG
>Rosalind_0544
GACCCCAATCTTTTAACACTAAGAGCGCTCCAAGGTGTAGCGCAACTTCTCGCAGCCGAG
TGTTGTGTGACCGTGTACGCGCAGAAGATTGAAAAGTCGGTAGAATGGGACCTCAACCCG
GATTCGAGAAGTGTAGCAGTTTGAATGTCTGCAGGAATTGGTCACTTTGGGGTTTCGTGT
ACGTACGCGAGGGTTGCTTTAATTCACCACGCGAGGCAGTCACGACGTCCCGTCTTGAGC
GGCTCGTCACTGGTGACTATTGTGCAAGACGAACCACACGTGCATAGCCCGCATTTTGTA
TTGCAACTAGGCGGACGTTCATCGTTCTAAGAAGTAATTAGCTCCTTTGATTGTCAACAT
CCCACCTCAATTTTCCTGATTCTAAGGGCACAGTTAGAAGACCACAGCATACTCGGGCGT
TTACTTCACTGAATTGTAAGCTCCATGAAGTTCCAGGAGCGGAGGAGTCGCAATATCAAA
GGAGGTTCGATCTAGATCATTCAAACAGAATAAGCGACCCAGTGACAATACACCTCCTGT
ATGATGCAAATTGAAGCTCGGAGCTAACAATGAAGGGAAGCCTGTCTGAGCGTGTTGTGG
CTTCTGAACTGGCGTTCTCCTGATGCGGAGCTCCGAATTGCTCCAAATTTTCTGTACGAC
ACGCACTAAGAGCCATCCTAGGGACACTTTGGACTGGTCTTACCATGAGACTATCCGTCT
TGGGAACCACAACTAATGCTGTGTGGCATAAACCGATTATTATACCGTGGATGGGTTATT
CCAGTGCCTTTGCCCGAAGTAGCAAGCACAGGCGAGCATAATTCTTCGAACGGGCGCGCC
GTCCCGCGCCCGGGAGCTGAGGACTGTATTCGGTCACCCATCTCACAACGCCCGCCCGAG
TCCCAGTGAAACCTGCAACAGG

